appId: com.example.smartsub
productName: SmartSub
copyright: Copyright Â© 2024 buxuku
directories:
  output: dist
  buildResources: resources
files:
  - from: .
    filter:
      - package.json
      - app
publish:
  - provider: github
    owner: MaurUppi
    repo: SmartSub
generateUpdatesFilesForAllChannels: true
electronUpdaterCompatibility: '>=2.16'
mac:
  target:
    - zip
    - dmg
  artifactName: '${productName}_Mac_${version}_${arch}_${env.OPENVINO_VERSION}.${ext}'
  publish:
    - provider: github
      owner: MaurUppi
      repo: SmartSub
      channel: latest
  extraResources:
    - from: ./extraResources/addons/
      to: ./extraResources/addons/
      filter:
        - '**/*'
    - from: ./extraResources/ggml-silero-v5.1.2.bin
      to: ./extraResources/ggml-silero-v5.1.2.bin
    # Conditional OpenVINO addon packaging - only when OPENVINO_VERSION is set
    - from: ./extraResources/addon-macos-arm-openvino.node
      to: ./extraResources/addons/addon-macos-arm-openvino.node
      filter: "${env.OPENVINO_VERSION ? '**/*' : []}"
    - from: ./extraResources/addon-macos-x86-openvino.node
      to: ./extraResources/addons/addon-macos-x86-openvino.node
      filter: "${env.OPENVINO_VERSION ? '**/*' : []}"
win:
  target:
    - nsis
  extraResources:
    - from: ./extraResources/addons/
      to: ./extraResources/addons/
      filter:
        - '**/*'
    - from: ./extraResources/ggml-silero-v5.1.2.bin
      to: ./extraResources/ggml-silero-v5.1.2.bin
    # Conditional OpenVINO addon packaging - only when OPENVINO_VERSION is set
    - from: ./extraResources/addon-windows-openvino.node
      to: ./extraResources/addons/addon-windows-openvino.node
      filter: "${env.OPENVINO_VERSION ? '**/*' : []}"
    - from: ./extraResources/addon-windows-openvino-u22.node
      to: ./extraResources/addons/addon-windows-openvino-u22.node
      filter: "${env.OPENVINO_VERSION ? '**/*' : []}"
  requestedExecutionLevel: asInvoker
  artifactName: '${productName}_Windows_${version}_${arch}_${env.OPENVINO_VERSION}.${ext}'
  publish:
    - provider: github
      owner: MaurUppi
      repo: SmartSub
      channel: latest
linux:
  target:
    - AppImage
    - tar.gz
    - deb
  category: AudioVideo
  artifactName: '${productName}_Linux_${version}_${arch}_${env.OPENVINO_VERSION}.${ext}'
  publish:
    - provider: github
      owner: MaurUppi
      repo: SmartSub
      channel: latest
  extraResources:
    - from: ./extraResources/addons/
      to: ./extraResources/addons/
      filter:
        - '**/*'
    - from: ./extraResources/ggml-silero-v5.1.2.bin
      to: ./extraResources/ggml-silero-v5.1.2.bin
    # Conditional OpenVINO addon packaging - only when OPENVINO_VERSION is set
    - from: ./extraResources/addon-linux-openvino.node
      to: ./extraResources/addons/addon-linux-openvino.node
      filter: "${env.OPENVINO_VERSION ? '**/*' : []}"
    - from: ./extraResources/addon-linux-openvino-u22.node
      to: ./extraResources/addons/addon-linux-openvino-u22.node
      filter: "${env.OPENVINO_VERSION ? '**/*' : []}"
nsis:
  oneClick: false
  perMachine: false
  allowToChangeInstallationDirectory: true
  deleteAppDataOnUninstall: false
  differentialPackage: false
asarUnpack:
  # Use ffmpeg-ffprobe-static for all ffmpeg and ffprobe needs (eliminates redundancy)
  - 'node_modules/ffmpeg-ffprobe-static/ffprobe' # Unix/Linux/macOS binary
  - 'node_modules/ffmpeg-ffprobe-static/ffprobe.exe' # Windows binary
  - 'node_modules/ffmpeg-ffprobe-static/ffmpeg' # Unix/Linux/macOS binary
  - 'node_modules/ffmpeg-ffprobe-static/ffmpeg.exe' # Windows binary
  - 'node_modules/ffmpeg-ffprobe-static/index.js' # Cross-platform path resolver
  - 'node_modules/ffmpeg-ffprobe-static/package.json' # Package metadata
